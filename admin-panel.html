<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="robots" content="noindex, nofollow" />
  <title>ISP Cloud Admin</title>

  <!-- Fonts to match public site -->
  <link
    href="https://fonts.googleapis.com/css2?family=Mukta:wght@300;400;600;800&family=Outfit:wght@300;500;700;900&display=swap"
    rel="stylesheet" />

  <!-- Libs -->
  <link rel="preconnect" href="https://cdn.tailwindcss.com" />
  <link rel="preconnect" href="https://unpkg.com" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

  <!-- Scripts -->
  <script src="https://cdn.tailwindcss.com" defer></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js" defer></script>

    <!-- Admin Styles -->
  <link rel="stylesheet" href="assets/css/admin.css" />
</head>

<body class="antialiased selection:bg-cyan-500 selection:text-black">

  <!-- LOGIN (modal overlay) -->
  <div id="auth-modal" class="fixed inset-0 z-[3000] flex items-center justify-center p-4 admin-login-bg">
    <div class="login-card glass-panel w-full max-w-sm text-center relative overflow-hidden">
      <div class="absolute -top-24 -left-24 w-64 h-64 rounded-full bg-cyan-500/20 blur-3xl"></div>
      <div class="absolute -bottom-10 -right-10 w-52 h-52 rounded-full bg-purple-500/20 blur-3xl"></div>

      <div class="mb-6 flex items-center justify-center gap-3">
        <div
          class="w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center shadow-[0_0_30px_rgba(6,182,212,0.35)]">
          <i class="fas fa-bolt text-black"></i>
        </div>
        <div class="text-left">
          <div class="text-[10px] font-extrabold tracking-widest text-cyan-300">CLOUD ADMIN</div>
          <h2 class="text-xl font-black tracking-tight">ISP Control Panel</h2>
        </div>
      </div>

      <input type="email" id="admin-email" placeholder="Email" class="mb-3" />
      <!-- Password with eye toggle -->
<div class="relative mb-4">
  <input
    type="password"
    id="admin-pass"
    placeholder="Password"
    class="pr-12 w-full"
    autocomplete="current-password"
  />
  <button
    type="button"
    id="toggle-pass"
    class="pass-eye-btn"
    aria-label="Show password"
    aria-pressed="false"
    title="Show/Hide password"
  >
    <i id="toggle-pass-icon" class="fas fa-eye"></i>
  </button>
</div>
      <button id="login-btn" onclick="adminLogin()"
        class="w-full bg-cyan-500 text-black font-extrabold py-3 rounded-lg shadow-lg hover:shadow-cyan-500/30 transition flex items-center justify-center gap-2">
        <i class="fas fa-right-to-bracket"></i> LOGIN
      </button>
      <p id="login-error" class="text-red-400 text-xs mt-4"></p>
    </div>
  </div>

  <!-- APP -->
  <div id="app-ui" class="hidden min-h-screen">

    <!-- Header -->
    <header class="admin-header relative sticky top-0 z-40">
      <div class="max-w-7xl mx-auto px-3 md:px-6 py-4 pt-[env(safe-area-inset-top)]">
        <nav
          class="glass-panel rounded-2xl px-3 md:px-6 py-3 flex flex-wrap items-center gap-2 md:gap-3 overflow-hidden relative">
          <!-- glow -->
          <div
            class="absolute left-10 top-1/2 -translate-y-1/2 w-24 h-24 bg-cyan-500/40 blur-[60px] opacity-40 pointer-events-none">
          </div>

          <!-- Left: Brand -->
          <div class="flex items-center gap-3 relative z-10 min-w-0 flex-1">
            <div
              class="w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center shadow-[0_0_30px_rgba(6,182,212,0.35)] shrink-0">
              <i class="fas fa-cloud text-black"></i>
            </div>
            <div class="min-w-0">
              <!-- Truncate name on very small widths instead of forcing nav to overflow -->
              <h1 class="text-lg md:text-xl font-black tracking-tight leading-tight truncate">
                ISP Dashboard
              </h1>
            </div>
          </div>

          <!-- Right: Actions -->
          <!-- On small screens this row wraps and actions go full width below the brand -->
          <div
            class="flex items-center gap-2 md:gap-3 ml-auto shrink-0 w-full sm:w-auto justify-between sm:justify-end">
            <a href="index.html" class="btn btn-ghost shrink-0">
              <i class="fas fa-eye mr-2"></i> <span class="hidden xs:inline">Site</span><span
                class="xs:hidden">Site</span>
            </a>
            <button id="save-btn" onclick="saveToCloud()" class="btn btn-primary shrink-0">
              <i class="fas fa-save mr-2"></i> <span class="hidden xs:inline">Save</span><span
                class="xs:hidden">Save</span>
            </button>
            <button onclick="firebase.auth().signOut()" class="btn btn-danger shrink-0" title="Sign Out"
              aria-label="Sign Out">
              <i class="fas fa-power-off"></i>
            </button>
          </div>
        </nav>
      </div>
      <div class="header-accent"></div>
    </header>

    <!-- Main Layout -->
    <main class="max-w-7xl mx-auto px-3 md:px-6 pb-12 grid grid-cols-1 lg:grid-cols-[240px_1fr] gap-4 md:gap-6">

      <!-- Sidebar Tabs -->
      <aside class="glass-panel rounded-2xl p-3 md:p-4 h-max sticky top-4 hidden lg:block">
        <div class="text-[10px] font-bold uppercase tracking-widest text-gray-400 px-2 mb-2">Navigation</div>
        <div class="flex flex-col gap-2">

          <button onclick="switchTab('status')" id="tab-status" class="tab-btn active sidebar-tab" data-tab="status"
            aria-selected="true">
            <i class="fa-solid fa-satellite-dish mr-2"></i> Status
          </button>
          <button onclick="switchTab('plans')" id="tab-plans" class="tab-btn sidebar-tab" data-tab="plans"
            aria-selected="false">
            <i class="fa-solid fa-bahai mr-2"></i> Plans
          </button>
          <button onclick="switchTab('map')" id="tab-map" class="tab-btn sidebar-tab" data-tab="map"
            aria-selected="false">
            <i class="fa-solid fa-map-location-dot mr-2"></i> Coverage
          </button>
          <button onclick="switchTab('footer')" id="tab-footer" class="tab-btn sidebar-tab" data-tab="footer"
            aria-selected="false">
            <i class="fa-solid fa-pen-nib mr-2"></i> Footer
          </button>
          <button onclick="switchTab('branding')" id="tab-branding" class="tab-btn sidebar-tab" data-tab="branding"
            aria-selected="false">
            <i class="fa-solid fa-palette mr-2"></i> ISP Details
          </button>

        </div>
      </aside>

      <!-- Mobile Tabs -->
      <div class="lg:hidden glass-panel rounded-2xl p-2 -mt-2">
        <!-- Added id="mobile-tabs-strip" for JS to be able to center the clicked tab -->
        <div id="mobile-tabs-strip" class="flex gap-1 overflow-x-auto no-scrollbar snap-x snap-mandatory">
          <button onclick="switchTab('status')" id="tab-status-mobile"
            class="tab-btn active px-4 py-3 text-sm whitespace-nowrap snap-center" data-tab="status"
            aria-selected="true">üì° Status</button>
          <button onclick="switchTab('plans')" id="tab-plans-mobile"
            class="tab-btn px-4 py-3 text-sm whitespace-nowrap snap-center" data-tab="plans" aria-selected="false">üí∞
            Plans</button>
          <button onclick="switchTab('map')" id="tab-map-mobile"
            class="tab-btn px-4 py-3 text-sm whitespace-nowrap snap-center" data-tab="map" aria-selected="false">üó∫Ô∏è
            Coverage</button>
          <button onclick="switchTab('footer')" id="tab-footer-mobile"
            class="tab-btn px-4 py-3 text-sm whitespace-nowrap snap-center" data-tab="footer" aria-selected="false">üìù
            Footer</button>
          <button onclick="switchTab('branding')" id="tab-branding-mobile"
            class="tab-btn px-4 py-3 text-sm whitespace-nowrap snap-center" data-tab="branding" aria-selected="false">üé®
            ISP Details</button>
        </div>
      </div>

      <!-- Content -->
      <section class="space-y-6">

        <!-- STATUS -->
        <div id="view-status" class="view-section">
          <div class="glass-panel rounded-2xl p-5 md:p-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="font-bold text-red-400 uppercase text-xs tracking-widest">Emergency Controls</h2>
              <span class="text-[10px] text-white/60">Set outage reason &amp; ETA per zone</span>
            </div>
            <div id="zone-list-status" class="space-y-3"></div>
          </div>
        </div>

        <!-- PLANS -->
        <div id="view-plans" class="view-section hidden">
          <button onclick="addNewPlan()"
            class="w-full py-4 mb-6 rounded-xl border-2 border-dashed border-cyan-500/30 text-cyan-400 font-bold bg-cyan-900/10 hover:bg-cyan-900/20 transition">
            <i class="fas fa-plus-circle"></i> ADD NEW PLAN
          </button>
          <div id="plans-editor-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
        </div>

        <!-- MAP -->
        <div id="view-map" class="view-section hidden">
          <div class="grid grid-cols-1 lg:grid-cols-[1fr_320px] gap-4">
            <!-- Map -->
            <div class="glass-panel rounded-2xl overflow-hidden relative bg-gray-900 p-1 order-2 lg:order-1">
              <div class="absolute top-4 right-4 z-[1000] flex flex-col gap-2">
                <button onclick="toggleMapScroll()" id="map-lock-btn"
                  class="bg-white text-black w-12 h-12 rounded-full shadow-2xl flex items-center justify-center">
                  <i class="fas fa-lock"></i>
                </button>
              </div>

              <div id="admin-map"></div>

              <div class="absolute top-2 left-2 text-[10px] text-white/70 bg-black/40 rounded px-2 py-1">
                Right‚Äëclick to remove ¬∑ <kbd>Backspace</kbd> undo ¬∑ <kbd>Esc</kbd> cancel
              </div>

              <div id="map-controls" class="absolute bottom-6 left-0 right-0 z-[1000] px-4 flex justify-center gap-3">
                <button id="finish-poly-btn" onclick="finishPolygon()"
                  class="hidden bg-green-500 text-black font-black px-8 py-4 rounded-full shadow-2xl flex items-center gap-2">
                  <i class="fas fa-check"></i> SAVE ZONE
                </button>
                <button id="cancel-draw-btn" onclick="cancelDrawing()"
                  class="hidden bg-gray-700 text-white font-bold px-6 py-4 rounded-full">
                  CANCEL
                </button>
              </div>
            </div>

            <!-- Zones List -->
            <div class="glass-panel rounded-2xl p-5 flex flex-col h-[350px] md:h-[600px] order-1 lg:order-2">
              <h3 class="font-bold mb-4 text-xs tracking-widest text-gray-400">ZONE MANAGER</h3>
              <div id="map-zone-list" class="flex-1 overflow-y-auto space-y-2 mb-4 custom-scroll pr-1"></div>
              <button id="add-zone-btn" onclick="startNewZone()"
                class="w-full bg-cyan-500 text-black font-bold py-4 rounded-xl shadow-lg hover:shadow-cyan-500/40 transition">
                <i class="fas fa-plus mr-2"></i> CREATE NEW ZONE
              </button>
            </div>
          </div>
        </div>

        <!-- FOOTER / SOCIALS -->
        <div id="view-footer" class="view-section hidden">
          <div class="glass-panel rounded-2xl p-6 md:p-10 max-w-2xl mx-auto space-y-6">
            <h2 class="text-xl font-bold text-cyan-400">Footer &amp; Socials</h2>
            <div>
              <label class="label">About Us</label>
              <textarea id="foot-about" rows="4"></textarea>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div><label class="label">Support Email</label><input type="text" id="foot-email"
                  placeholder="support@example.com" /></div>
              <div><label class="label">Address</label><input type="text" id="foot-address" placeholder="Address" />
              </div>
              <div><label class="label" for="foot-hours">Support Hours</label><input id="foot-hours" type="text"
                  placeholder="10 AM ‚Äì 7 PM" />
                <p class="text-xs text-gray-400 mt-1">Shown in footer (e.g., ‚Äú10 AM ‚Äì 7 PM‚Äù)</p>
              </div>
            </div>
            <div>
              <label class="label">WhatsApp Number</label>
              <input type="text" id="foot-wa" inputmode="numeric" placeholder="e.g. 919876543210 (no + sign)" />
              <p class="hint">Tip: Enter with country code.</p>
            </div>
            <div class="pt-4 border-t border-white/10 space-y-3">
              <div class="flex items-center gap-3"><i class="fab fa-facebook text-blue-500"></i><input type="text"
                  id="foot-fb" placeholder="FB URL" /></div>
              <div class="flex items-center gap-3"><i class="fab fa-instagram text-pink-500"></i><input type="text"
                  id="foot-insta" placeholder="Insta URL" /></div>
            </div>
          </div>
        </div>

        <!-- BRANDING -->
        <div id="view-branding" class="view-section hidden">
          <div class="glass-panel rounded-2xl p-6 md:p-10 max-w-3xl mx-auto space-y-6">
            <h2 class="text-xl font-bold text-cyan-400">Logo &amp; ISP Details</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="glass-panel p-4 rounded-lg">
                <label class="label">Brand Mode</label>
                <div class="flex flex-wrap gap-4 mt-2">
                  <label class="inline-flex items-center gap-2"><input type="radio" name="brand-mode"
                      id="brand-mode-text" value="text" class="accent-cyan-400"><span>Text</span></label>
                  <label class="inline-flex items-center gap-2"><input type="radio" name="brand-mode"
                      id="brand-mode-logo" value="logo" class="accent-cyan-400"><span>Logo</span></label>
                  <label class="inline-flex items-center gap-2"><input type="radio" name="brand-mode"
                      id="brand-mode-both" value="both" class="accent-cyan-400"><span>Both</span></label>
                </div>
              </div>
              <div class="glass-panel p-4 rounded-lg">
                <label class="label">Brand Text</label>
                <input type="text" id="brand-text" placeholder="e.g. JOISTER BROADBAND" />
                <label class="label mt-2 mb-1">TITLE SUFFIX</label>
                <input type="text" id="conf-title-suffix" placeholder="e.g. Broadband ‚Ä¢ Thane" />
              </div>
            </div>

            <div class="glass-panel p-4 rounded-lg">
              <label class="label">Upload Logo</label>
              <div class="grid grid-cols-1 md:grid-cols-[1fr_auto] gap-4 items-center">
                <div class="flex items-center gap-3">
                  <input type="file" id="brand-logo-file" accept="image/*" />
                  <button id="clear-logo-btn" class="btn btn-danger-ghost">Clear</button>
                </div>
              </div>
              <div class="brand-preview mt-4">
                <div class="brand-preview-card">
                  <div class="brand-preview-title">Preview</div>
                  <div class="flex items-center gap-3">
                    <img id="brand-logo-preview" src="" alt="Logo" class="h-10 hidden" />
                    <span id="brand-text-preview" class="text-white font-black text-xl tracking-tight">ISP</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="glass-panel p-4 rounded-lg">
              <label class="label">Favicon / App Icon Generator</label>

              <!-- Inputs: From / To / Size -->
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-3">
                <div class="space-y-2">
                  <label class="label block">From</label>
                  <div class="favicon-input">
                    <input type="color" id="ico-color-1" value="#22d3ee" class="favicon-color" />
                  </div>
                </div>

                <div class="space-y-2">
                  <label class="label block">To</label>
                  <div class="favicon-input">
                    <input type="color" id="ico-color-2" value="#3b82f6" class="favicon-color" />
                  </div>
                </div>

                <div class="space-y-2">
                  <label class="label block">Size</label>
                  <select id="ico-size" class="w-full favicon-select">
                    <option value="256">256 √ó 256</option>
                    <option value="192">192 √ó 192 (Android)</option>
                    <option value="32">32 √ó 32</option>
                  </select>
                </div>
              </div>

              <!-- Mode radios -->
              <div class="mt-3 flex flex-wrap items-center gap-4">
                <label class="inline-flex items-center gap-2">
                  <input type="radio" name="ico-mode" id="ico-mode-lightning" value="lightning" class="accent-cyan-400"
                    checked>
                  <span>Lightning</span>
                </label>
                <label class="inline-flex items-center gap-2">
                  <input type="radio" name="ico-mode" id="ico-mode-initials" value="initials" class="accent-cyan-400">
                  <span>Initials</span>
                </label>
                <div id="ico-initials-wrap" class="hidden">
                  <input type="text" id="ico-initials" maxlength="3" placeholder="e.g. JB" class="w-24">
                </div>
              </div>

              <!-- Actions -->
              <div class="mt-4 flex flex-wrap items-center gap-3">
                <button id="gen-favicon-btn" class="btn btn-primary">
                  <i class="fas fa-bolt mr-2"></i>Generate Icon
                </button>
                <button id="use-favicon-as-logo-btn" class="btn btn-ghost hidden">
                  <i class="fas fa-image mr-2"></i>Use as Logo
                </button>
                <span id="gen-favicon-toast" class="text-xs text-green-400 opacity-0 transition">Generated ‚úì</span>
              </div>

              <!-- Preview -->
              <div class="mt-4">
                <div class="favicon-preview-card">
                  <div class="favicon-preview-title">Preview</div>
                  <div class="flex items-center gap-3">
                    <img id="favicon-preview" src="" alt="Favicon" class="favicon-preview-img" />
                    <!-- Optional: live size note -->
                    <span id="favicon-preview-size" class="text-xs text-gray-400"></span>
                  </div>
                </div>
              </div>
            </div>

            <div class="glass-panel p-4 rounded-lg">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div><label class="label">COMPANY NAME</label><input type="text" id="conf-name" /></div>
                <div><label class="label">PHONE NUMBER</label><input type="text" id="conf-phone"
                    placeholder="e.g. 9876543210" /></div>
                <div><label class="label">UPI ID</label><input type="text" id="conf-upi"
                    placeholder="e.g. yourupi@bank" /></div>
                <div><label class="label">SERVICE CITIES</label><input type="text" id="conf-area"
                    placeholder="Comma-separated e.g. Mumbai, Thane, Navi Mumbai" /></div>
              </div>
            </div>
          </div>
        </div>

      </section>
    </main>
  </div>

  <!-- Zone Modal -->
  <div id="zone-modal" class="fixed inset-0 z-[4000] bg-black/70 hidden">
    <div class="min-h-full w-full flex items-center justify-center p-4">
      <div class="glass-panel w-full max-w-md rounded-xl border border-white/10 shadow-2xl">
        <div class="flex items-center justify-between p-4 border-b border-white/10">
          <h3 id="zone-modal-title" class="text-sm font-bold text-cyan-400 uppercase tracking-widest">Zone Details</h3>
          <button onclick="closeZoneModal()" class="text-white/70 hover:text-white"><i
              class="fas fa-times"></i></button>
        </div>
        <div class="p-4 space-y-4">
          <div><label class="label">Zone Name</label><input type="text" id="new-zone-name" placeholder="e.g. Sector 21"
              class="w-full" /></div>
          <div><label class="label">City</label><select id="new-zone-city" class="w-full"></select></div>
        </div>
        <div class="p-4 pt-0 flex items-center justify-end gap-2">
          <button onclick="closeZoneModal()" class="btn btn-ghost">Cancel</button>
          <button onclick="confirmZoneDetails()" class="btn btn-success"><i class="fas fa-check mr-1"></i> Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts (your existing) -->
  <script src="config/firebase.js" defer></script>
  <script src="core/utils.js" defer></script>
  <script src="admin-core/admin.core.js" defer></script>
  <script src="admin-core/admin.branding.js" defer></script>
  <script src="admin-core/admin.status.js" defer></script>
  <script src="admin-core/admin.plans.js" defer></script>
  <script src="admin-core/admin.map.js" defer></script>
</body>

</html>
